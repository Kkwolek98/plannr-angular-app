import{a as y}from"./chunk-QKX4UP7R.js";import{a as Q,b as X,c as ee,d as te,e as ie}from"./chunk-3W42FSIL.js";import{b as z,d as O,e as U,f as G,g as w,i as L,j as W,k as q,l as Z,q as H,r as J,s as N,u as K}from"./chunk-7M27L2PM.js";import{$ as E,D as c,G as B,I as $,J as s,O as b,Sa as C,U as R,V as v,W as p,X as P,Xa as A,Za as Y,_ as T,aa as F,ba as M,ca as a,da as l,ea as h,g as V,ha as d,ia as D,p as _,q as x,qa as m,r as f,ra as j,sa as k,ya as g}from"./chunk-IYJWUTWN.js";function pe(e,t){if(e&1&&m(0),e&2){let r=t.$implicit;k(" ",r.name," ")}}function me(e,t){if(e&1&&m(0),e&2){let r=t.$implicit;k(" ",r.description," ")}}function ce(e,t){if(e&1&&(a(0,"span",5),m(1),l()),e&2){let r=t.$implicit;s(),j(r)}}function de(e,t){if(e&1&&F(0,ce,2,1,"span",6,E),e&2){let r=t.$implicit;M(r.tags)}}function ue(e,t){if(e&1&&m(0),e&2){let r=t.$implicit;k(" ",r.videos==null?null:r.videos.length," ")}}var oe=(()=>{let t=class t{constructor(){this.data=_()}rowClicked(i){console.log({row:i})}};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=f({type:t,selectors:[["app-exercises-table"]],inputs:{data:[x.SignalBased,"data"]},standalone:!0,features:[g],decls:5,vars:2,consts:[[3,"data","cardBreakpoint","rowClick"],["appTableColumn","","headerDef","Name"],["appTableColumn","","headerDef","Description"],["appTableColumn","","headerDef","Tags"],["appTableColumn","","headerDef","Videos"],[1,"px-2","py-0.5","bg-slate-300","rounded-lg"],["class","px-2 py-0.5 bg-slate-300 rounded-lg"]],template:function(o,n){o&1&&(a(0,"app-table",0),d("rowClick",function(S){return n.rowClicked(S.row)}),v(1,pe,1,1,"ng-template",1)(2,me,1,1,"ng-template",2)(3,de,2,0,"ng-template",3)(4,ue,1,1,"ng-template",4),l()),o&2&&p("data",n.data())("cardBreakpoint","sm")},dependencies:[C,ee,X],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0});let e=t;return e})();function fe(e,t){if(e&1&&(a(0,"div",2),h(1,"app-spinner",3),l()),e&2){let r=D();P("width",r.width,"px")("height",r.height,"px")}}var ne=(()=>{let t=class t{constructor(){this.sanitizer=c(A),this.width=_(184),this.height=_(180),this.url=_(void 0,{transform:i=>{if(!i)return;let o=this.getEmbeddedLink(i);return this.sanitizer.bypassSecurityTrustResourceUrl(o)}}),this.loading=b(!0)}setLoadingFalse(){setTimeout(()=>{this.loading.set(!1)},100)}getEmbeddedLink(i){let o=i.match(/(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/(?:[^/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|\S*?[?&]v=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/)?.[1];if(!o)throw Error("Invalid YouTube link");return`https://www.youtube.com/embed/${o}`}};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=f({type:t,selectors:[["app-youtube-video"]],inputs:{width:[x.SignalBased,"width"],height:[x.SignalBased,"height"],url:[x.SignalBased,"url"]},standalone:!0,features:[g],decls:2,vars:4,consts:[["frameborder","0","allowfullscreen","",3,"width","height","src","load"],["class","flex justify-center items-center",3,"width","height"],[1,"flex","justify-center","items-center"],["size","lg"]],template:function(o,n){o&1&&(a(0,"iframe",0),d("load",function(){return n.setLoadingFalse()}),l(),v(1,fe,2,4,"div",1)),o&2&&(p("width",n.loading()?0:n.width)("height",n.loading()?0:n.height)("src",n.url(),$),s(),T(1,n.loading()?1:-1))},dependencies:[C,J],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0});let e=t;return e})();function re(e){return e.value.startsWith("https://www.youtube.com")?null:{startsWithYoutube:{value:e.value}}}function he(e,t){if(e&1&&h(0,"app-youtube-video",13),e&2){let r=t.$implicit;p("url",r)}}function ge(e,t){if(e&1&&(a(0,"div",12),F(1,he,1,1,"app-youtube-video",13,E),l()),e&2){let r=D();s(),M(r)}}function Ce(e,t){e&1&&v(0,ge,3,0,"div",11),e&2&&T(0,t.length?0:-1)}var ae=(()=>{let t=class t extends ie{constructor(){super(...arguments),this.exercisesService=c(y),this.loading=b(!1),this.form=new G({name:new w("",{nonNullable:!0,validators:[z.required]}),description:new w(""),videos:new w([],{nonNullable:!0}),tags:new w([],{nonNullable:!0})}),this.newVideoFormControl=new w("",{nonNullable:!0,validators:[re]})}addVideoToArray(){if(this.newVideoFormControl.invalid)throw Error("Invalid video url");this.form.get("videos")?.value.push(this.newVideoFormControl.value),this.newVideoFormControl.setValue("")}create(){if(this.form.invalid)throw Error("Invalid exercise form");this.loading.set(!0);let i=this.form.value;this.exercisesService.createExercise$(i).subscribe({next:()=>{this.form.reset(),this.close(!0)},error:()=>{},complete:()=>{this.loading.set(!1)}})}};t.\u0275fac=(()=>{let i;return function(n){return(i||(i=B(t)))(n||t)}})(),t.\u0275cmp=f({type:t,selectors:[["app-new-exercise-modal"]],standalone:!0,features:[R,g],decls:15,vars:6,consts:[[1,"w-[80vw]","md:w-[36rem]",3,"formGroup"],[1,"w-auto","md:w-96","mx-auto"],["name","name","formControlName","name","label","Name"],["type","textarea","name","description","formControlName","description","label","Description"],["formControlName","tags",1,"mb-3"],[1,"flex","items-end","gap-4","w-100","mb-5"],["name","video","label","New video URL",1,"flex-1",3,"formControl"],["variant","outlined",1,"mb-4",3,"disabled","click"],[1,"flex","justify-end","gap-4","w-100","mx-auto"],["color","secondary",3,"click"],[3,"disabled","loading","click"],["class","flex flex-wrap gap-3 w-100 mb-3"],[1,"flex","flex-wrap","gap-3","w-100","mb-3"],[3,"url"]],template:function(o,n){if(o&1&&(a(0,"form",0)(1,"div",1),h(2,"app-input",2)(3,"app-input",3)(4,"app-tag-input",4),a(5,"div",5),h(6,"app-input",6),a(7,"app-button",7),d("click",function(){return n.addVideoToArray()}),m(8,"Add"),l()()(),v(9,Ce,1,1),a(10,"div",8)(11,"app-button",9),d("click",function(){return n.close()}),m(12,"Cancel"),l(),a(13,"app-button",10),d("click",function(){return n.create()}),m(14,"Create"),l()()()),o&2){let u,S;p("formGroup",n.form),s(6),p("formControl",n.newVideoFormControl),s(),p("disabled",n.newVideoFormControl.invalid),s(2),T(9,(u=(S=n.form.get("videos"))==null?null:S.value)?9:-1,u),s(4),p("disabled",n.form.invalid)("loading",n.loading())}},dependencies:[C,H,L,O,U,W,q,Z,K,N,ne,te],styles:["[_nghost-%COMP%]{display:block}.modal-container[_ngcontent-%COMP%]{width:36rem}"],changeDetection:0});let e=t;return e})();var le=(()=>{let t=class t{constructor(){this.route=c(Y),this.modalsService=c(Q),this.exercisesService=c(y),this.exercises=b([]),this.route.data.pipe(V(i=>i.exercises)).subscribe({next:i=>{this.exercises.set(i)}})}openNewExerciseModal(){let i=this.modalsService.newModal(ae,{title:"Create new exercise"});i.closed$.subscribe({next:o=>{o&&this.refetchData()}}),i.open()}refetchData(){this.exercisesService.getAllExercises$().subscribe(i=>{this.exercises.set(i)})}};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=f({type:t,selectors:[["app-exercises-page"]],standalone:!0,features:[g],decls:4,vars:1,consts:[[1,"p-2","flex","flex-col","gap-2"],["shape","circle",1,"self-end",3,"click"],[3,"data"]],template:function(o,n){o&1&&(a(0,"main",0)(1,"app-button",1),d("click",function(){return n.openNewExerciseModal()}),m(2,"+"),l(),h(3,"app-exercises-table",2),l()),o&2&&(s(3),p("data",n.exercises()))},dependencies:[oe,C,N],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0});let e=t;return e})();var se=()=>c(y).getAllExercises$();var ht=[{path:"",component:le,resolve:{exercises:se}}];export{ht as exerciseRoutes};
