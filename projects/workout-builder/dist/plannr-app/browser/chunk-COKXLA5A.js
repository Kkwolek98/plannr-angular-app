import{a as He}from"./chunk-QKX4UP7R.js";import{a as Ue}from"./chunk-EE6GGRKG.js";import{a as he,b as N}from"./chunk-CBDB6PPI.js";import{a as $e}from"./chunk-E2KADIVF.js";import{a as qe,b as W,c as Ge,d as $,e as H,f as L,g as k,h as Le,i as U,j as pe,k as z,l as J,m as Ae,n as Ke,o as Qe,p as me,q,s as B,t as Ye,u as X}from"./chunk-7M27L2PM.js";import{$ as be,$a as je,Aa as G,C as ve,D as c,Ga as We,Ha as Ne,J as l,L as xe,N as O,O as y,Oa as j,Pa as Pe,Q as oe,Qa as Ve,Sa as b,Ta as Re,V as S,W as d,X as we,Y as ne,Za as Oe,_ as v,a as _e,aa as A,b as Ce,ba as K,ca as a,cb as Y,da as s,db as de,ea as f,fa as ke,g as Z,ga as F,ha as h,ia as m,ja as re,ka as ae,la as ye,m as R,ma as Ie,na as se,o as te,oa as le,p as g,pa as De,q as _,qa as u,r as x,ra as V,sa as M,t as Se,ta as Q,ua as Ee,v as D,va as Be,w as E,wa as Te,xa as Fe,ya as w,z as ie,za as Me}from"./chunk-IYJWUTWN.js";var ze=(()=>{let i=class i{constructor(){this.http=c(Re)}addSetItemToSet$(t,o){return this.http.post(Y.url+"/sets/"+t+"/items",o)}updateSetItem$(t,o){return this.http.put(Y.url+"/sets/items/"+t,o)}removeSet$(t){return this.http.delete(Y.url+"/sets/"+t)}updateSet$(t,o){return this.http.put(Y.url+"/sets/"+t,o)}removeSetItem$(t){return this.http.delete(Y.url+"/sets/items/"+t)}};i.\u0275fac=function(o){return new(o||i)},i.\u0275prov=ie({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();var I=(()=>{let i=class i{constructor(){this.workoutsService=c(Ue),this.setsService=c(ze),this._dataSignal=y(void 0),this.editedSetItemId=y(null),this.data=he(this._dataSignal),this.openSetsIds=y(new Set),this.editedSetItemId$=he(this.editedSetItemId)}setWorkout(t){this._dataSignal.set(t)}clearWorkout(){this._dataSignal.set(void 0)}updateWorkoutDetails(t){return this.workoutsService.updateWorkout$(this._dataSignal().id,t).pipe(R(o=>{this._dataSignal.set(o)}))}toggleSet(t){let o=this.openSetsIds();o.has(t)?o.delete(t):o.add(t),this.openSetsIds.set(new Set(o))}setItemId(t){this.editedSetItemId.set(t)}addEmptySet(){let t=this._dataSignal()?.id;if(!t)throw Error("Workout not set");return this.workoutsService.createEmptySet(t).pipe(R(o=>{this._dataSignal.set(o)}))}removeSet(t){return this.setsService.removeSet$(t).pipe(R(({removed:o})=>{if(!o)throw Error("Set was not removed");let n=this._dataSignal();n.sets=n.sets.filter(p=>p.id!==t),n.sets=n.sets.map((p,C)=>Ce(_e({},p),{sort:C})),this._dataSignal.set(structuredClone(n))}))}updateSet(t,o){return this.setsService.updateSet$(t,o).pipe(R(n=>{let p=this._dataSignal(),C=p?.sets.findIndex(P=>P.id===t);if(C===void 0||C<0)throw Error("Invalid set id");p.sets[C]=n,this._dataSignal.set(structuredClone(p))}))}addSetItemToSet(t,o){return this.setsService.addSetItemToSet$(t,o).pipe(R(n=>{let p=this._dataSignal(),C=p?.sets.findIndex(P=>P.id===t);if(C===void 0||C<0)throw Error("Invalid set id");p.sets[C]=n,this._dataSignal.set(structuredClone(p))}))}updateSetItem(t,o){return this.setsService.updateSetItem$(t,o).pipe(R(n=>{let p=this._dataSignal(),C=p?.sets.findIndex(fe=>fe.setItems.map(dt=>dt.id).includes(t));if(C===void 0||C<0)throw Error("Invalid set id");let P=p.sets[C].setItems.findIndex(fe=>fe.id===t);if(P===void 0||P<0)throw Error("Invalid set item id");p.sets[C].setItems[P]=n,this._dataSignal.set(structuredClone(p))}))}removeSetItem(t){return this.setsService.removeSetItem$(t).pipe(R(({removed:o})=>{if(!o)throw Error("Set item was not removed");let n=this._dataSignal(),p=n?.sets.findIndex(C=>C.setItems.map(P=>P.id).includes(t));if(p===void 0||p<0)throw Error("Invalid set id");n.sets[p].setItems=n.sets[p].setItems.filter(C=>C.id!==t),this._dataSignal.set(structuredClone(n))}))}};i.\u0275fac=function(o){return new(o||i)},i.\u0275prov=ie({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();var ue=function(e){return e.Sets="sets",e.Details="details",e.Preview="preview",e}(ue||{});var pt=(e,i)=>({"text-gray-400 italic":e,"text-gray-900":i});function mt(e,i){if(e&1&&(a(0,"div",3)(1,"div"),u(2,"Description:"),s(),a(3,"div",4),u(4),s()()),e&2){let r=m(),t,o;l(3),d("ngClass",G(2,pt,!((t=r.data())!=null&&t.description),(t=r.data())==null?null:t.description)),l(),M(" ",((o=r.data())==null?null:o.description)||"No description"," ")}}function ut(e,i){if(e&1&&(a(0,"form",5),f(1,"app-input",6)(2,"app-input",7),s()),e&2){let r=m();d("formGroup",r.form)}}function ct(e,i){if(e&1){let r=F();a(0,"app-button",8),h("click",function(){D(r);let o=m();return E(o.toggleEditMode())}),u(1,"Cancel"),s(),a(2,"app-button",9),h("click",function(){D(r);let o=m();return E(o.saveChanges())}),u(3,"Save"),s()}if(e&2){let r=m();l(2),d("disabled",r.form.invalid||!r.form.dirty)}}function ft(e,i){if(e&1){let r=F();a(0,"app-button",10),h("click",function(){D(r);let o=m();return E(o.toggleEditMode())}),u(1,"Edit"),s()}}var Je=(()=>{let i=class i{constructor(){this.workoutBuilderService=c(I),this.notificationsService=c($e),this.data=N(this.workoutBuilderService.data),this.isEditMode=y(!1),this.form=new L({name:new k("",{validators:[W.required]}),description:new k("")})}toggleEditMode(){let t=this.isEditMode();if(!t){let o=this.data();o&&this.form.setValue({name:o.name,description:o.description})}this.isEditMode.set(!t)}saveChanges(){if(this.form.invalid)throw Error("Form is invalid");let t=this.form.value;this.workoutBuilderService.updateWorkoutDetails(t).subscribe({next:()=>{this.isEditMode.set(!1),this.notificationsService.open({message:"Workout details updated",type:"success"})},error:()=>{this.notificationsService.open({message:"Failed to update workout details",type:"error"})}})}};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=x({type:i,selectors:[["app-workout-builder-details"]],standalone:!0,features:[w],decls:6,vars:2,consts:[[1,"flex","flex-col","gap-2","p-2"],["class","flex gap-4"],[1,"flex","gap-2"],[1,"flex","gap-4"],[3,"ngClass"],[1,"flex","flex-col","max-w-96",3,"formGroup"],["formControlName","name","label","Name",1,"mb-2"],["formControlName","description","label","Description","type","textarea"],["variant","outlined",3,"click"],[3,"disabled","click"],[3,"click"]],template:function(o,n){o&1&&(a(0,"div",0),S(1,mt,5,5,"div",1)(2,ut,3,1),a(3,"div",2),S(4,ct,4,1)(5,ft,2,0),s()()),o&2&&(l(),v(1,n.isEditMode()?2:1),l(3),v(4,n.isEditMode()?4:5))},dependencies:[b,j,X,q,U,$,H,z,J,B],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0});let e=i;return e})();var ce=(()=>{let i=class i{constructor(){this.templateRef=c(xe)}};i.\u0275fac=function(o){return new(o||i)},i.\u0275dir=Se({type:i,selectors:[["","appDrawer",""]],exportAs:["appDrawer"],standalone:!0});let e=i;return e})();var ht=["*"],Xe=(()=>{let i=class i{constructor(){this.width=g("300px"),this.initialOpenState=g(!1),this.isOpen=y(this.initialOpenState())}open(){this.isOpen.set(!0)}close(){this.isOpen.set(!1)}toggle(){this.isOpen.set(!this.isOpen())}};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=x({type:i,selectors:[["app-drawer-container"]],contentQueries:function(o,n,p){if(o&1&&ye(p,ce,5),o&2){let C;se(C=le())&&(n.drawer=C.first)}},inputs:{width:[_.SignalBased,"width"],initialOpenState:[_.SignalBased,"initialOpenState"]},standalone:!0,features:[w],ngContentSelectors:ht,decls:4,vars:3,consts:[[1,"flex","[&>*:first-child]:flex-1"],[1,"overflow-hidden","transition-[width]","ease-in-out","duration-500","[&>*:first-child]:text-nowrap"],[3,"ngTemplateOutlet"]],template:function(o,n){o&1&&(re(),a(0,"div",0),ae(1),a(2,"div",1),ke(3,2),s()()),o&2&&(l(2),we("width",n.isOpen()?n.width():"0px"),l(),d("ngTemplateOutlet",n.drawer.templateRef))},dependencies:[b,Pe],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0});let e=i;return e})();var gt=(e,i)=>({"me-2 flex items-center":e,"mb-1":i});function _t(e,i){if(e&1&&(a(0,"label",1),u(1),s()),e&2){let r=m();d("htmlFor",r.inputId)("ngClass",G(3,gt,r.labelPosition()==="left",r.labelPosition()==="top")),l(),V(r.label())}}function Ct(e,i){if(e&1&&(a(0,"option",4),u(1),s()),e&2){let r=i.$implicit,t=m();d("value",r[t.valueKey()]),l(),V(r[t.labelKey()])}}function St(e,i){if(e&1&&f(0,"app-validation-error",3),e&2){let r=m();d("formControl",r.formControl)}}var vt=(e,i)=>({"flex-row align-middle":e,"flex-col":i}),Ze=(()=>{let i=class i{get formControl(){return this.ngControl.control}constructor(){this.cdref=c(oe),this.ngControl=c(Ge),this.name=g(""),this.label=g(),this.labelPosition=g("top"),this.placeholder=g(),this.disabled=g(!1,{transform:t=>(this.setDisabledState(t),t)}),this.data=g.required(),this.valueKey=g.required(),this.labelKey=g.required(),this.inputId=de("select"),this.isDisabled=!1,this.value="",this.ngControl.valueAccessor=this}writeValue(t){this.value=t,this.cdref.detectChanges()}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this.isDisabled=t,this.cdref.detectChanges()}onModelChange(){this.onChange(this.value)}};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=x({type:i,selectors:[["app-select"]],inputs:{name:[_.SignalBased,"name"],label:[_.SignalBased,"label"],labelPosition:[_.SignalBased,"labelPosition"],placeholder:[_.SignalBased,"placeholder"],disabled:[_.SignalBased,"disabled"],data:[_.SignalBased,"data"],valueKey:[_.SignalBased,"valueKey"],labelKey:[_.SignalBased,"labelKey"]},standalone:!0,features:[w],decls:6,vars:10,consts:[[1,"form-group","flex",3,"ngClass"],[3,"htmlFor","ngClass"],[1,"h-8","border","border-slate-500","outline-emerald-700","rounded-sm",3,"name","id","ngModel","disabled","ngModelChange"],[3,"formControl"],[3,"value"]],template:function(o,n){o&1&&(a(0,"div",0),S(1,_t,2,6,"label",1),a(2,"select",2),Te("ngModelChange",function(C){return Be(n.value,C)||(n.value=C),C}),h("ngModelChange",function(){return n.onModelChange()}),A(3,Ct,2,2,"option",4,be),s(),S(5,St,1,1,"app-validation-error",3),s()),o&2&&(d("ngClass",G(7,vt,n.labelPosition()==="left",n.labelPosition()==="top")),l(),v(1,n.label()?1:-1),l(),d("name",n.name())("id",n.inputId),Ee("ngModel",n.value),d("disabled",n.isDisabled),l(),K(n.data()),l(2),v(5,n.ngControl.control?5:-1))},dependencies:[b,j,me,Ke,Qe,Ae,$,Le,Ye,q,pe],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0});let e=i;return e})();function xt(e,i){if(e&1&&u(0),e&2){let r=m();M(" ",r.label(),`
`)}}function wt(e,i){if(e&1&&u(0),e&2){let r=m();M(" ",r.label()," ")}}var bt=(e,i)=>({"bg-emerald-500":e,"bg-slate-500":i}),et=(()=>{let i=class i{constructor(){this.cdref=c(oe),this.name=g(""),this.label=g(),this.labelTrue=g("Yes"),this.labelFalse=g("No"),this.labelPosition=g("top"),this.inputId=de("toggle"),this.isDisabled=!1,this.value=!1}writeValue(t){this.value=t,this.cdref.detectChanges()}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this.isDisabled=t}onModelChange(){this.onChange(this.value)}toggle(){this.isDisabled||(this.value=!this.value,this.onModelChange(),this.onTouched())}};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=x({type:i,selectors:[["app-toggle"]],inputs:{name:[_.SignalBased,"name"],label:[_.SignalBased,"label"],labelTrue:[_.SignalBased,"labelTrue"],labelFalse:[_.SignalBased,"labelFalse"],labelPosition:[_.SignalBased,"labelPosition"]},standalone:!0,features:[Fe([{provide:qe,useExisting:ve(()=>i),multi:!0}]),w],decls:9,vars:13,consts:[[1,"flex","items-center","cursor-pointer",3,"htmlFor"],[1,"relative","ms-1"],["type","checkbox",1,"hidden",3,"id","disabled","checked","change"],[1,"w-12","h-6","rounded-full","shadow-inner","transform","duration-200",3,"ngClass"],[1,"dot","absolute","w-6","h-6","bg-white","rounded-full","shadow","inset-y-0","left-0","transition-transform","transform","duration-200"],[1,"ml-3","text-gray-700","font-medium"]],template:function(o,n){o&1&&(S(0,xt,1,1),a(1,"label",0),S(2,wt,1,1),a(3,"div",1)(4,"input",2),h("change",function(){return n.toggle()}),s(),f(5,"div",3)(6,"div",4),s(),a(7,"div",5),u(8),s()()),o&2&&(v(0,n.labelPosition()==="top"?0:-1),l(),d("htmlFor",n.inputId),l(),v(2,n.labelPosition()==="left"?2:-1),l(2),d("id",n.inputId)("disabled",n.isDisabled)("checked",n.value),l(),d("ngClass",G(10,bt,n.value,!n.value)),l(),ne("translate-x-full",n.value),l(2),M(" ",n.value?n.labelTrue():n.labelFalse()," "))},dependencies:[b,j],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0});let e=i;return e})();var tt=[{key:"kg",value:"kg"},{key:"lb",value:"lb"},{key:"RPE",value:"RPE"},{key:"min",value:"minutes"},{key:"s",value:"seconds"}];function kt(e,i){e&1&&f(0,"app-input",16)}function yt(e,i){e&1&&f(0,"app-input",17)(1,"app-input",18)}var it=(()=>{let i=class i{get isExactRepsControl(){return this.formFlow.get("isExactReps")}get hasRestControl(){return this.formFlow.get("hasRest")}get hasLoadControl(){return this.formFlow.get("hasLoad")}constructor(){this.exercisesService=c(He),this.workoutBuilder=c(I),this.setId=g.required(),this.editedSetItem=g(null,{transform:t=>(t&&(this.formFlow.setValue({isExactReps:t.repExact!==null,hasLoad:t.repWeight!==null,hasRest:t.rest!==null}),this.form.setValue({details:t.details.id,repMin:t.repMin,repMax:t.repMax,repExact:t.repExact,repType:t.repType,repWeight:t.repWeight,sort:t.sort,rest:t.rest})),t)}),this.closed=new te,this.exercises=N(this.exercisesService.getAllExercises$()),this.form=new L({details:new k("",{nonNullable:!0}),repMin:new k(null,{validators:[W.min(0)]}),repMax:new k(null,{validators:[W.min(1)]}),repExact:new k(null,{validators:[W.min(1)]}),repType:new k("kg",{nonNullable:!0}),repWeight:new k(null,{validators:[W.min(0)]}),sort:new k(0,{nonNullable:!0}),rest:new k(null,{validators:[W.min(0)]})}),this.formFlow=new L({isExactReps:new k(!1,{nonNullable:!0}),hasLoad:new k(!0,{nonNullable:!0}),hasRest:new k(!0,{nonNullable:!0})}),this.repTypes=tt,this.hasLoadControl.valueChanges.subscribe(t=>{let o=this.form.get("repWeight"),n=this.form.get("repType");t?(o?.setValue(this.previousLoad),o?.enable(),n?.enable()):(this.previousLoad=o?.value,o?.setValue(null),o?.disable(),n?.disable())})}save(){if(this.form.invalid)return this.form.markAllAsTouched();this.editedSetItem()?this.saveEdited():this.saveNew()}saveNew(){this.workoutBuilder.addSetItemToSet(this.setId(),this.form.value).subscribe({next:()=>{this.closed.emit()}})}saveEdited(){this.workoutBuilder.updateSetItem(this.editedSetItem().id,this.form.value).subscribe({next:()=>{this.workoutBuilder.setItemId(null)}})}};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=x({type:i,selectors:[["app-workout-builder-set-form"]],inputs:{setId:[_.SignalBased,"setId"],editedSetItem:[_.SignalBased,"editedSetItem"]},outputs:{closed:"closed"},standalone:!0,features:[w],decls:22,vars:7,consts:[[1,"flex","flex-col","gap-3","max-w-96",3,"formGroup"],["label","Exercise","valueKey","id","labelKey","name","formControlName","details",3,"data"],[1,"flex"],["label","Reps","labelFalse","Range","labelTrue","Exact",1,"w-1/3",3,"formControl"],[1,"flex","gap-2","items-end"],["class","w-20","label","number","formControlName","repExact","type","number"],[1,"flex","items-end"],["label","Enable weight",1,"w-1/3",3,"formControl"],["formControlName","repWeight","type","number",1,"w-20"],["formControlName","repType","valueKey","key","labelKey","value",3,"data"],["label","Enable rest",1,"w-1/3",3,"formControl"],["formControlName","rest","type","number",1,"w-20"],[1,"mb-4"],[1,"flex","justify-end","gap-2","mt-2"],[3,"click"],["variant","outlined","color","secondary",3,"click"],["label","number","formControlName","repExact","type","number",1,"w-20"],["label","min","formControlName","repMin","type","number",1,"w-20"],["label","max","formControlName","repMax","type","number",1,"w-20"]],template:function(o,n){o&1&&(a(0,"form",0),f(1,"app-select",1),a(2,"div",2),f(3,"app-toggle",3),a(4,"div",4),S(5,kt,1,0,"app-input",5)(6,yt,2,0),s()(),a(7,"div",6),f(8,"app-toggle",7),a(9,"div",6),f(10,"app-input",8)(11,"app-select",9),s()(),a(12,"div",6),f(13,"app-toggle",10)(14,"app-input",11),a(15,"div",12),u(16,"\xA0seconds"),s()(),a(17,"div",13)(18,"app-button",14),h("click",function(){return n.save()}),u(19,"Save"),s(),a(20,"app-button",15),h("click",function(){return n.closed.emit()}),u(21,"Cancel"),s()()()),o&2&&(d("formGroup",n.form),l(),d("data",n.exercises()),l(2),d("formControl",n.isExactRepsControl),l(2),v(5,n.isExactRepsControl.value?5:6),l(3),d("formControl",n.hasLoadControl),l(3),d("data",n.repTypes),l(2),d("formControl",n.hasRestControl))},dependencies:[b,X,me,U,$,H,q,pe,z,J,Ze,B,et],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0});let e=i;return e})();function It(e,i){if(e&1&&u(0),e&2){let r=m();Q(" ",r.setItem().repMin," - ",r.setItem().repMax," ")}}function Dt(e,i){if(e&1&&u(0),e&2){let r=m();M(" ",r.setItem().repExact," ")}}function Et(e,i){if(e&1&&u(0),e&2){let r=m();Q(" ",r.setItem().repWeight,"",r.setItem().repType," ")}}function Bt(e,i){if(e&1&&(a(0,"div",10),u(1),s()),e&2){let r=m();l(),M(" ",r.setItem().details.description," ")}}var ot=(()=>{let i=class i{constructor(){this.workoutBuilderService=c(I),this.index=g.required(),this.setItem=g.required(),this.isRemovingSet=y(!1),this.hasRepRange=O(()=>this.setItem().repMin!==null&&this.setItem().repMax!==null),this.hasLoad=O(()=>this.setItem().repWeight!==null)}removeItem(){this.isRemovingSet.set(!0),this.workoutBuilderService.removeSetItem(this.setItem().id).subscribe({complete:()=>{this.isRemovingSet.set(!1)}})}enableEdit(){this.workoutBuilderService.setItemId(this.setItem().id)}};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=x({type:i,selectors:[["app-workout-builder-set-item"]],inputs:{index:[_.SignalBased,"index"],setItem:[_.SignalBased,"setItem"]},standalone:!0,features:[w],decls:18,vars:7,consts:[[1,"flex","flex-col"],[1,"flex","justify-between","items-center","h-6"],[1,"text-lg"],[1,"flex","gap-1"],["color","clean",3,"click"],[1,"fa-solid","fa-pen","text-slate-400","hover:text-yellow-600"],["color","clean",3,"loading","click"],[1,"fa-solid","fa-trash","text-slate-400","hover:text-red-600"],[1,"flex","flex-col","text-slate-600","mt-0.5"],["class","mt-1"],[1,"mt-1"]],template:function(o,n){o&1&&(a(0,"div",0)(1,"div",1)(2,"div",2),u(3),s(),a(4,"div",3)(5,"app-button",4),h("click",function(){return n.enableEdit()}),f(6,"i",5),s(),a(7,"app-button",6),h("click",function(){return n.removeItem()}),f(8,"i",7),s()()(),a(9,"div",8)(10,"div"),S(11,It,1,2)(12,Dt,1,1),u(13," x "),S(14,Et,1,2),s(),a(15,"div"),u(16),s(),S(17,Bt,2,1,"div",9),s()()),o&2&&(l(3),Q("",n.index()+1,". ",n.setItem().details.name,""),l(4),d("loading",n.isRemovingSet()),l(4),v(11,n.hasRepRange()?11:12),l(3),v(14,n.hasLoad()?14:-1),l(2),V(n.setItem().rest?n.setItem().rest+"s rest":"No rest"),l(),v(17,n.setItem().details.description?17:-1))},dependencies:[b,B],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0});let e=i;return e})();var Tt=(e,i)=>i.id;function Ft(e,i){if(e&1){let r=F();a(0,"app-workout-builder-set-form",3),h("closed",function(){D(r);let o=m(3);return E(o.addingNewExercise.set(!1))}),s()}if(e&2){let r=m().$implicit,t=m(2);d("editedSetItem",r)("setId",t.set().id)}}function Mt(e,i){if(e&1&&f(0,"app-workout-builder-set-item",4),e&2){let r=m(),t=r.$implicit,o=r.$index;d("setItem",t)("index",o)}}function Wt(e,i){if(e&1&&(S(0,Ft,1,2,"app-workout-builder-set-form",2),We(1,"async"),S(2,Mt,1,2)),e&2){let r=i.$implicit,t=m(2);v(0,Ne(1,1,t.editedSetItemId$)===r.id?0:2)}}function Nt(e,i){if(e&1&&A(0,Wt,3,3,null,null,Tt),e&2){let r=m();K(r.set().setItems)}}function Pt(e,i){e&1&&(a(0,"div",5),u(1,"No exercises found"),s())}function Vt(e,i){if(e&1){let r=F();a(0,"div",6)(1,"app-button",7),h("click",function(){D(r);let o=m();return E(o.addNewExercise())}),u(2,"Add Exercise"),s()()}}function Rt(e,i){if(e&1){let r=F();a(0,"app-workout-builder-set-form",8),h("closed",function(){D(r);let o=m();return E(o.addingNewExercise.set(!1))}),s()}if(e&2){let r=m();d("setId",r.set().id)}}var nt=(()=>{let i=class i{constructor(){this.workoutBuilderService=c(I),this.set=g.required(),this.addingNewExercise=y(!1),this.isOpen=O(()=>this.workoutBuilderService.openSetsIds().has(this.set().id)),this.editedSetItemId$=this.workoutBuilderService.editedSetItemId$}addNewExercise(){this.addingNewExercise.set(!0),this.workoutBuilderService.setItemId(null)}};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=x({type:i,selectors:[["app-workout-builder-set-body"]],inputs:{set:[_.SignalBased,"set"]},standalone:!0,features:[w],decls:5,vars:2,consts:[[1,"w-full","bg-slate-100","p-4"],["class","w-full flex justify-center mt-2"],[3,"editedSetItem","setId"],[3,"editedSetItem","setId","closed"],[1,"mb-2",3,"setItem","index"],[1,"w-full","text-slate-600","flex","justify-center"],[1,"w-full","flex","justify-center","mt-2"],["variant","outlined",3,"click"],[3,"setId","closed"]],template:function(o,n){o&1&&(a(0,"div",0),S(1,Nt,2,0)(2,Pt,2,0)(3,Vt,3,0,"div",1)(4,Rt,1,1),s()),o&2&&(l(),v(1,n.set().setItems.length?1:n.addingNewExercise()?-1:2),l(2),v(3,n.addingNewExercise()?4:3))},dependencies:[b,Ve,B,ot,it],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0});let e=i;return e})();var Ot=["*"],rt=(()=>{let i=class i{};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=x({type:i,selectors:[["app-workout-builder-set-container"]],standalone:!0,features:[w],ngContentSelectors:Ot,decls:1,vars:0,template:function(o,n){o&1&&(re(),ae(0))},dependencies:[b],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0});let e=i;return e})();function jt(e,i){if(e&1){let r=F();a(0,"app-button",5),h("click",function(){D(r);let o=m();return E(o.saveChanges())}),f(1,"i",7),s()}if(e&2){let r=m();d("loading",r.isSavingChanges())}}function $t(e,i){if(e&1){let r=F();a(0,"app-button",5),h("click",function(){D(r);let o=m();return E(o.removeSet())}),f(1,"i",8),s()}if(e&2){let r=m();d("loading",r.isDeletingSet())}}function qt(e,i){if(e&1&&(a(0,"div"),u(1),s(),a(2,"div"),u(3),s(),a(4,"div"),u(5),s()),e&2){let r=m(),t,o,n;l(),V((t=r.drawerData())==null?null:t.name),l(2),V((o=r.drawerData())==null?null:o.description),l(2),V(((n=r.drawerData())==null?null:n.rest)===null?"No rest":((n=r.drawerData())==null?null:n.rest)+"s rest")}}function Gt(e,i){if(e&1&&(a(0,"form",9),f(1,"app-input",10)(2,"app-input",11)(3,"app-input",12),s()),e&2){let r=m();d("formGroup",r.editForm)}}var at=(()=>{let i=class i{constructor(){this.workoutBuilderService=c(I),this.drawerData=g(null,{transform:t=>(this.isDeletingSet.set(!1),this.isSavingChanges.set(!1),this.isEditMode.set(!1),t)}),this.closeDrawer=new te,this.isDeletingSet=y(!1),this.isSavingChanges=y(!1),this.isEditMode=y(!1),this.editForm=new L({name:new k("",{nonNullable:!0,validators:W.required}),description:new k("",{nonNullable:!0}),rest:new k(0,{nonNullable:!0,validators:W.min(0)})})}toggleEditMode(){this.isEditMode.set(!this.isEditMode()),this.populateForm()}populateForm(){let t=this.drawerData();if(!t)throw Error("No set data provided");this.editForm.setValue({name:t.name,description:t.description,rest:t.rest??0})}saveChanges(){this.isSavingChanges.set(!0),this.workoutBuilderService.updateSet(this.drawerData().id,this.editForm.value).subscribe({next:()=>{this.toggleEditMode()},complete:()=>{this.isSavingChanges.set(!1)}})}removeSet(){this.isDeletingSet.set(!0),this.workoutBuilderService.removeSet(this.drawerData().id).subscribe({next:()=>{this.closeDrawer.emit()},complete:()=>{this.isDeletingSet.set(!1)}})}};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=x({type:i,selectors:[["app-workout-builder-set-details-drawer"]],inputs:{drawerData:[_.SignalBased,"drawerData"]},outputs:{closeDrawer:"closeDrawer"},standalone:!0,features:[w],decls:11,vars:8,consts:[[1,"px-3"],[1,"flex","justify-between","items-c"],[1,"text-2xl","font-bold"],[1,"flex","gap-1"],["color","clean",3,"loading"],["color","clean",3,"loading","click"],[1,"fa-solid","text-slate-400","hover:text-yellow-600"],[1,"fa-solid","fa-check","text-slate-400","hover:text-green-600"],[1,"fa-solid","fa-trash","text-slate-400","hover:text-red-600"],[3,"formGroup"],["label","Name","formControlName","name"],["label","Description","type","textarea","formControlName","description"],["label","Rest (s)","type","number","formControlName","rest"]],template:function(o,n){o&1&&(a(0,"div",0)(1,"div",1)(2,"h2",2),u(3,"Set details"),s(),a(4,"div",3),S(5,jt,2,1,"app-button",4),a(6,"app-button",5),h("click",function(){return n.toggleEditMode()}),f(7,"i",6),s(),S(8,$t,2,1,"app-button",4),s()(),S(9,qt,6,3)(10,Gt,4,1),s()),o&2&&(l(5),v(5,n.isEditMode()?5:-1),l(),d("loading",n.isSavingChanges()),l(),ne("fa-pen",!n.isEditMode())("fa-close",n.isEditMode()),l(),v(8,n.isEditMode()?-1:8),l(),v(9,n.isEditMode()?10:9))},dependencies:[b,q,U,$,H,z,J,B,X],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0});let e=i;return e})();var Lt=e=>({"transform rotate-180":e}),st=(()=>{let i=class i{constructor(){this.workoutBuilderService=c(I),this.set=g.required(),this.index=g.required(),this.setLetter=O(()=>String.fromCharCode(65+this.index())),this.isOpen=O(()=>this.workoutBuilderService.openSetsIds().has(this.set().id))}toggleSetOpen(){this.workoutBuilderService.toggleSet(this.set().id)}};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=x({type:i,selectors:[["app-workout-builder-set-header"]],inputs:{set:[_.SignalBased,"set"],index:[_.SignalBased,"index"]},standalone:!0,features:[w],decls:5,vars:5,consts:[[1,"flex","items-center","h-10","w-100","px-4","bg-slate-200","border-b-2","border-slate-700","shadow-md","rounded-t-lg","cursor-pointer"],[1,"flex-1","text-left"],[1,"ps-2",3,"click"],[1,"fa-solid","fa-chevron-down",3,"ngClass"]],template:function(o,n){o&1&&(a(0,"div",0)(1,"button",1),u(2),s(),a(3,"button",2),h("click",function(C){return n.toggleSetOpen(),C.stopPropagation()}),f(4,"i",3),s()()),o&2&&(l(2),Q("",n.setLetter(),". ",n.set().name,""),l(2),d("ngClass",Me(3,Lt,n.isOpen())))},dependencies:[b,j],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0});let e=i;return e})();var At=["drawerContainer"],Kt=(e,i)=>i.id;function Qt(e,i){if(e&1&&f(0,"app-workout-builder-set-body",5),e&2){let r=m().$implicit;d("set",r)}}function Yt(e,i){if(e&1){let r=F();a(0,"app-workout-builder-set-container",3)(1,"app-workout-builder-set-header",4),h("click",function(){let n=D(r).$implicit,p=m();return E(p.toggleDrawer(n))}),s(),S(2,Qt,1,1,"app-workout-builder-set-body",5),s()}if(e&2){let r=i.$implicit,t=i.$index,o=m();l(),d("set",r)("index",t),l(),v(2,o.isOpen(r.id)?2:-1)}}function Ht(e,i){if(e&1){let r=F();a(0,"app-workout-builder-set-details-drawer",6),h("closeDrawer",function(){D(r),m();let o=De(1);return E(o.close())}),s()}if(e&2){let r=m();d("drawerData",r.drawerData())}}var lt=(()=>{let i=class i{constructor(){this.workoutBuilderService=c(I),this.sets=N(this.workoutBuilderService.data.pipe(Z(t=>t?.sets||[]))),this.drawerData=y(null)}addNewSet(){this.workoutBuilderService.addEmptySet().subscribe()}isOpen(t){return this.workoutBuilderService.openSetsIds().has(t)}toggleDrawer(t){!this.drawerData()||this.drawerData()?.id!==t.id?(this.drawerData.set(t),this.drawerContainer.open()):this.drawerData()?.id===t.id&&(this.drawerData.set(null),this.drawerContainer.close())}};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=x({type:i,selectors:[["app-workout-builder-sets"]],viewQuery:function(o,n){if(o&1&&Ie(At,5),o&2){let p;se(p=le())&&(n.drawerContainer=p.first)}},standalone:!0,features:[w],decls:8,vars:0,consts:[["drawerContainer",""],["appDrawer",""],[3,"click"],[1,"mb-2"],[3,"set","index","click"],[3,"set"],[3,"drawerData","closeDrawer"],["class","mb-2"]],template:function(o,n){o&1&&(a(0,"app-drawer-container",null,0)(2,"div"),A(3,Yt,3,3,"app-workout-builder-set-container",7,Kt),s(),S(5,Ht,1,1,"ng-template",1),s(),a(6,"app-button",2),h("click",function(){return n.addNewSet()}),u(7,"Add set"),s()),o&2&&(l(3),K(n.sets()))},dependencies:[b,rt,st,nt,B,Xe,ce,at],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0});let e=i;return e})();function Ut(e,i){e&1&&f(0,"app-workout-builder-sets")}function zt(e,i){e&1&&f(0,"app-workout-builder-details")}var Sn=(()=>{let i=class i{constructor(){this.activatedRoute=c(Oe),this.router=c(je),this.workoutBuilderService=c(I),this.workoutData=N(this.activatedRoute.data.pipe(Z(t=>t.workout))),this.activeTab=N(this.activatedRoute.queryParams.pipe(Z(t=>t.tab))),this.WorkoutTab=ue,this.workoutBuilderService.setWorkout(this.workoutData()),this.data=N(this.workoutBuilderService.data)}ngOnInit(){this.activeTab()||this.router.navigate([],{queryParams:{tab:ue.Sets}})}changeTab(t){this.router.navigate([],{queryParams:{tab:t}})}};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=x({type:i,selectors:[["app-workout-builder-page"]],standalone:!0,features:[w],decls:15,vars:5,consts:[[1,"h-18","px-4","py-3","mb-3","bg-slate-100","shadow-inner","flex","items-center"],[1,"text-xl","flex","items-center"],[1,"flex-1"],[1,"flex","gap-3"],[3,"variant","click"],[1,"px-2"]],template:function(o,n){if(o&1&&(a(0,"main")(1,"header",0)(2,"h2",1),u(3),s(),f(4,"div",2),a(5,"div",3)(6,"app-button",4),h("click",function(){return n.changeTab(n.WorkoutTab.Sets)}),u(7,"Sets"),s(),a(8,"app-button",4),h("click",function(){return n.changeTab(n.WorkoutTab.Details)}),u(9,"Details"),s(),a(10,"app-button",4),h("click",function(){return n.changeTab(n.WorkoutTab.Preview)}),u(11,"Preview"),s()()(),a(12,"section",5),S(13,Ut,1,0)(14,zt,1,0),s()()),o&2){let p,C;l(3),M(" ",(p=n.data())==null?null:p.name," "),l(3),d("variant",n.activeTab()===n.WorkoutTab.Sets?"filled":"outlined"),l(2),d("variant",n.activeTab()===n.WorkoutTab.Details?"filled":"outlined"),l(2),d("variant",n.activeTab()===n.WorkoutTab.Preview?"filled":"outlined"),l(3),v(13,(C=n.activeTab())===n.WorkoutTab.Sets?13:C===n.WorkoutTab.Details?14:-1)}},dependencies:[b,B,lt,Je],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0});let e=i;return e})();export{Sn as WorkoutBuilderPageComponent};
